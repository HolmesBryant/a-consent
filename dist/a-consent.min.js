if(window.gtagTrackingId){window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config",window.gtagTrackingId,{anonymize_ip:!0}),gtag("consent","default",{analytics_storage:"denied",ad_storage:"denied",ad_user_data:"denied",ad_personalization:"denied",wait_for_update:500});var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id="+encodeURIComponent(window.gtagTrackingId);var e=document.getElementsByTagName("script")[0];e&&e.parentNode?(e.parentNode.insertBefore(t,e),console.info("gtag.js script loaded for ID:",window.gtagTrackingId)):head?(document.head.append(t),console.info("gtag.js script loaded for ID:",window.gtagTrackingId)):console.error("Could not find a place to insert the gtag.js script.")}else console.warn("Google Analytics Tracking ID (window.gtagTrackingId) is not defined. gtag will not be loaded.");class a extends HTMLElement{#t=!0;#e=!1;#a=!1;#o=!1;#i=!1;#s="fade";#n=365;#r=!1;#l="required";#c=!1;#d=!0;#h=!1;abortController=new AbortController;analyticsInput;adTrackingInput;addPersonalizationInput;denyAllInput;functionalityInput;grantAllInput;savedConsent;static observedAttributes=["analytics","ad-tracking","ad-personalization","deny-all","effect","expire","force","functional","grant-all"];static storageKey="user_consent_preferences";static template=' <style> :host {--bg-color: hsl(0, 0%, 95%); --text-color: hsl(0, 0%, 15%); --border-color: hsl(0, 0%, 75%); --accent-color: dodgerblue; --accent-text: white; --min: 35px; --font-size: small; display: block; font-size: var(--font-size); max-width: 100%; opacity: 1; width: max-content; transition: opacity .3s ease-out; } button {background: var(--accent-color); border: 1px solid var(--border-color); border-radius: 3px; color: var(--accent-text); cursor: pointer; min-height: var(--min); } input:disabled {cursor: not-allowed; opacity: 0.9; } label {cursor: pointer; } main {background: var(--bg-color); border: 1px solid var(--border-color); border-radius: 10px; color: var(--text-color); padding: 1rem; } summary {cursor: pointer; } .row {align-items: center; display: grid; gap: 1rem; grid-template-columns: var(--min) 1fr var(--min); position: relative; } .row.left {justify-content: start; } .row input {width: var(--min); height: var(--min); } .tooltip div {background: var(--bg-color); border: 1px solid var(--bg-color); left: 0; padding: 0; position: absolute; width: calc(100% - 75px); z-index: -1; } .tooltip[open] div {box-shadow: 4px 4px 10px black; bottom: 0; padding: 1rem; z-index: 1; } .tooltip summary {align-items: center; box-sizing: border-box; justify-content: center; background: none; border: 1px solid var(--border-color); border-radius: 50%; display: flex; font-size: var(--min); font-weight: bold; height: var(--min); width: var(--min); } .tooltip summary:hover {box-shadow: 1px 1px 2px black; } .tooltip summary:active {box-shadow: inset 2px 2px 5px black; } .tooltip[open] summary {background: var(--accent-color); box-shadow: inset 2px 2px 5px black; color: var(--accent-text); } .tooltip summary::marker {content: ""; } #submit-input {width: 100%; } #submit-input:hover {box-shadow: 2px 2px 5px black; } #submit-input:active {background: unset; color: unset; box-shadow: inset 2px 2px 5px black; } </style> <main> <slot name="title"><strong>Data Consent</strong></slot> <slot name="description"> <p>Please allow us to store some cookies on your computer.</p> </slot> <form onsubmit="return false"> <div class="row"> <input type="radio" name="accept-deny-all" id="consent-all"> <label for="consent-all"> <slot name="grant-all-label">Allow All Cookies</slot> </label> <details class="tooltip"> <summary aria-label="more info">?</summary> <div> <slot name="grant-all-tooltip"> Accept storage and disclosing of data for: necessary cookies, analytics, advertising and ad personalization. </slot> </div> </details> </div> <div class="row"> <input type="radio" name="accept-deny-all" id="deny-all"> <label for="deny-all"> <slot name="deny-all-label">Necessary Cookies Only</slot> </label> <details class="tooltip"> <summary aria-label="more info">?</summary> <div> <slot name="deny-all-tooltip"> Deny consent to store or use any data except that which is needed to perform essential services such as session cookies, shopping cart cookies or security cookies. </slot> </div> </details> </div> <hr> <button type="submit" id="submit-input">Submit</button> <hr> <details> <summary> <slot name="details-label">Details</slot> </summary> <div class="row"> <input type="checkbox" id="analytics-storage"> <label for="analytics-storage"> <slot name="analytics-label">Internal Analytics</slot> </label> <details class="tooltip"> <summary aria-label="more info">?</summary> <div> <slot name="analytics-tooltip"> Data that allows us to count visits and traffic sources so we can measure and improve the performance of our site. </slot> </div> </details> </div> <div class="row"> <input type="checkbox" id="ad-storage"> <label> <slot name="ad-tracking-label">Ad Tracking</slot> </label> <details class="tooltip"> <summary aria-label="more info">?</summary> <div> <slot name="ad-tracking-tooltip"> Data gathered for the purpose of measuring the success or failure of our public outreach and advertising efforts. </slot> </div> </details> </div> <div class="row"> <input type="checkbox" id="ad-personalization"> <label> <slot name="ad-personalization-label">Ad Personalization</slot> </label> <details class="tooltip"> <summary aria-label="more info">?</summary> <div> <slot name="ad-personalization-tooltip"> Data gathered for the purpose of personalizing ads. This helps Google choose ads for products and services that better match your interests. </slot> </div> </details> </div> <div class="row"> <input type="checkbox" id="functionality-storage"> <label> <slot name="functionality-label">Necessary Cookies</slot> </label> <details class="tooltip"> <summary aria-label="more info">?</summary> <div> <slot name="functionality-tooltip"> Cookies needed to perform essential functions such as session cookies, shopping cart cookies or security cookies. </slot> </div> </details> </div> </details> </form> </main> ';constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){this.savedConsent=this.#u(a.storageKey),this.abortController.signal.aborted&&(this.abortController=new AbortController),this.savedConsent&&!this.force||(this.shadowRoot.innerHTML=a.template,this.form=this.shadowRoot.querySelector("form"),this.submitInput=this.shadowRoot.querySelector("#submit-input"),this.grantAllInput=this.shadowRoot.querySelector("#consent-all"),this.denyAllInput=this.shadowRoot.querySelector("#deny-all"),this.analyticsInput=this.shadowRoot.querySelector("#analytics-storage"),this.adTrackingInput=this.shadowRoot.querySelector("#ad-storage"),this.adPersonalizationInput=this.shadowRoot.querySelector("#ad-personalization"),this.functionalityInput=this.shadowRoot.querySelector("#functionality-storage"),this.grantAllInput.addEventListener("change",this.processInput.bind(this),{signal:this.abortController.signal}),this.denyAllInput.addEventListener("change",this.processInput.bind(this),{signal:this.abortController.signal}),this.analyticsInput.addEventListener("change",this.processInput.bind(this),{signal:this.abortController.signal}),this.adTrackingInput.addEventListener("change",this.processInput.bind(this),{signal:this.abortController.signal}),this.adPersonalizationInput.addEventListener("change",this.processInput.bind(this),{signal:this.abortController.signal}),this.functionalityInput.addEventListener("change",this.processInput.bind(this),{signal:this.abortController.signal}),this.submitInput.addEventListener("click",this.submitChoices.bind(this),{signal:this.abortController.signal}),this.init())}attributeChangedCallback(t,e,a){this[t=t.replace(/-(.)/g,((t,e)=>e.toUpperCase()))]=a}disconnectedCallback(){this.abortController.abort()}choices(){return{analytics_storage:this.analytics?"granted":"denied",ad_storage:this.adTracking?"granted":"denied",ad_user_data:this.#h?"granted":"denied",ad_personalization:this.adPersonalization?"granted":"denied",functionality_storage:!0===this.functional||"required"===this.functional?"granted":"denied",security_storage:this.#d?"granted":"denied"}}explodeElement(t,e={}){if(!(t&&t instanceof HTMLElement))return Promise.reject("Invalid element.");const a={particleCount:50,dotSize:100,duration:500,explosionRadius:200,easing:"ease-out",zIndex:9999,...e};return new Promise((e=>{const o=t.getBoundingClientRect(),i=window.scrollX||window.pageXOffset,s=window.scrollY||window.pageYOffset,n=o.left+i+o.width/2,r=o.top+s+o.height/2,l=[];t.style.transition=`opacity ${a.duration/4}ms ease-in`;for(let t=0;t<a.particleCount;t++){const t=document.createElement("div");t.style.position="absolute",t.style.left=n-a.dotSize/2+"px",t.style.top=r-a.dotSize/2+"px",t.style.width=`${a.dotSize}px`,t.style.height=`${a.dotSize}px`,t.style.borderRadius="50%",t.style.backgroundColor="#"+Math.floor(16777215*Math.random()).toString(16).padStart(6,"0"),t.style.zIndex=String(a.zIndex),t.style.pointerEvents="none",t.style.opacity="1",t.style.transition=`transform ${a.duration}ms ${a.easing}, opacity ${a.duration}ms ${a.easing}`,t.style.transform="translate(0, 0) scale(1)",document.body.appendChild(t),l.push(t)}requestAnimationFrame((()=>{t.style.visibility="hidden";for(const t of l){const e=2*Math.random()*Math.PI,o=Math.random()*a.explosionRadius,i=Math.cos(e)*o,s=Math.sin(e)*o;t.style.transform=`translate(${i}px, ${s}px) scale(0)`,t.style.opacity="0"}})),setTimeout((()=>{for(const t of l)t.remove();e()}),a.duration)}))}fadeElement(t){t.addEventListener("transitionend",(e=>{t.remove()}),{once:!0}),t.style.opacity=0}init(){this.savedConsent?(this.analyticsInput.checked="granted"===this.savedConsent.analytics_storage,this.adTrackingInput.checked="granted"===this.savedConsent.ad_storage,this.adPersonalizationInput.checked="granted"===this.savedConsent.ad_personalization,this.functionalityInput.checked="granted"===this.savedConsent.functionality_storage):(this.analyticsInput.checked=!!this.analytics,this.adTrackingInput.checked=!!this.adTracking,this.adPersonalizationInput.checked=!!this.adPersonalization,this.functionalityInput.checked=!0===this.functional||"required"===this.functional),"required"===this.functional&&(this.functionalityInput.disabled=!0)}#u(t){const e=localStorage.getItem(t);if(!e)return null;try{const a=JSON.parse(e);return(new Date).getTime()>a.expiry?(localStorage.removeItem(t),null):a}catch(e){return console.error("Error parsing item from localStorage or checking expiry:",e),localStorage.removeItem(t),null}}#g(t){try{localStorage.removeItem(t)}catch(e){console.error(`Error removing item "${t}" from localStorage:`,e)}}#p(t,e,a){if(!e.analytics_storage)return console.error("Consent data not set. Data is most likely not an object");const o=(new Date).getTime()+24*a*60*60*1e3;e.expiry=e.expiry?e.expiry:o;try{localStorage.setItem(t,JSON.stringify(e))}catch(t){console.error("Consent data not set",t)}}processInput(t){if(t instanceof Event==!1)throw new TypeError("0x00007FF723010001");if(!t.isTrusted&&!1===this.#t)throw new DOMException("0x00007FF723010002","SecurityError");const e=t.target;switch(t.isTrusted&&"radio"!==e.type&&(this.grantAllInput.checked=!1,this.denyAllInput.checked=!1),t.target.id){case"consent-all":e.checked&&(this.analytics=!0,this.adTracking=!0,this.userDataStorage=!0,this.adPersonalization=!0,"required"!==this.functional&&(this.functional=!0));break;case"deny-all":e.checked&&(this.analytics=!1,this.adTracking=!1,this.userDataStorage=!1,this.adPersonalization=!1,"required"!==this.functional&&(this.functional=!1));break;case"analytics-storage":this.analytics=!!e.checked;break;case"ad-storage":e.checked?(this.adTracking=!0,this.userDataStorage=!0):(this.adTracking=!1,this.adPersonalization||(this.userDataStorage=!1));break;case"ad-personalization":e.checked?(this.adPersonalization=!0,this.userDataStorage=!0):(this.adPersonalization=!1,this.adTracking||(this.userDataStorage=!1));break;case"functionality-storage":"required"!==this.functional&&(this.functional=!!e.checked)}return this.choices()}resetConsent(){this.#g(a.storageKey),window.location.reload()}async submitChoices(t){if(t.preventDefault(),t instanceof Event==!1)throw new TypeError("0x00007FF723010003");if(!t.isTrusted&&!1===this.#t)throw new DOMException("0x00007FF723010004","SecurityError");await this.#m(this.choices(),window.gtag),"fade"===this.effect?this.fadeElement(this):(await this.explodeElement(this),this.remove())}async#m(t,e){try{e("consent","update",t),this.#p(a.storageKey,t,this.expire);if(this.closest("dialog")){const t=this.getRootNode();"a-consent-edit"===t.host.localName&&t.host.hideForm()}return!0}catch(t){return console.error("Update failed",t),this.style.display="none",!1}}get grantAll(){return this.#c}set grantAll(t){switch("string"==typeof t&&(t=t.toLowerCase()),t){case!1:case"false":this.#c=!1;break;default:this.#c=!0,this.#i=!1,this.#o=!0,this.#a=!0,this.#e=!0,"required"!==this.#l&&(this.#l=!0),this.#h=!0,this.#d=!0}}get denyAll(){return this.#i}set denyAll(t){switch("string"==typeof t&&(t=t.toLowerCase()),t){case!1:case"false":this.#i=!1;break;default:this.#i=!0,this.#c=!1,this.#o=!1,this.#a=!1,this.#e=!1,"required"!==this.#l&&(this.#l=!1),this.#h=!1,this.#d="required"===this.#l}}get adPersonalization(){return this.#e}set adPersonalization(t){switch("string"==typeof t&&(t=t.toLowerCase()),t){case"false":case!1:this.#e=!1,this.adTracking||(this.#h=!1),this.adPersonalizationInput&&(this.adPersonalizationInput.checked=!1);break;default:this.#e=!0,this.#h=!0,this.adPersonalizationInput&&(this.adPersonalizationInput.checked=!0)}}get adTracking(){return this.#a}set adTracking(t){switch("string"==typeof t&&(t=t.toLowerCase()),t){case"false":case!1:this.#a=!1,this.adPersonalization||(this.#h=!1),this.adTrackingInput&&(this.adTrackingInput.checked=!1);break;default:this.#a=!0,this.#h=!0,this.adTrackingInput&&(this.adTrackingInput.checked=!0)}}get analytics(){return this.#o}set analytics(t){switch("string"==typeof t&&(t=t.toLowerCase()),t){case"false":case!1:this.#o=!1,this.analyticsInput&&(this.analyticsInput.checked=!1);break;default:this.#o=!0,this.analyticsInput&&(this.analyticsInput.checked=!0)}}get effect(){return this.#s}set effect(t){this.#s=t}get expire(){return this.#n}set expire(t){t=+t,isNaN(t)&&console.error(`Could not set expire on localStorage because the new value was: ${t}`);const e=this.#u(a.storageKey),o=JSON.parse(e);try{e&&(delete o.expiry,this.#p(a.storageKey,o,t)),this.#n=t}catch(t){console.error("Could not set expire date",t)}}get force(){return this.#r}set force(t){switch(t){case"false":case!1:this.#r=!1;break;default:this.#r=!0}}get functional(){return this.#l}set functional(t){switch("string"==typeof t&&(t=t.toLowerCase()),t){case"false":case!1:this.#l=!1,this.#d=!1,this.functionalityInput&&(this.functionalityInput.checked=!1);break;case"required":this.#l="required",this.#d=!0,this.functionalityInput&&(this.functionalityInput.checked=!0,this.functionalityInput.disabled=!0);break;default:this.#l=!0,this.#d=!0,this.functionalityInput&&(this.functionalityInput.checked=!0)}}}document.addEventListener("DOMContentLoaded",(()=>{customElements.get("a-consent")||customElements.define("a-consent",a)}));class o extends HTMLElement{abortController=new AbortController;abortTransitionController=null;dialog=null;consentForm=null;static template=' <style> :host {--bg-color: hsl(0, 0%, 95%); --text-color: hsl(0, 0%, 15%); --border-color: hsl(0, 0%, 75%); --accent-color: dodgerblue; --accent-text: white; --min: 35px; --font-size: small; } a { color: var(--accent-color); } button {border-radius: 10px; border: 1px solid var(--border-width); cursor: pointer; height: var(--min); width: var(--min); font-size: var(--min); line-height: 0; padding: 0; } button:hover {background: var(--accent-color); box-shadow: 1px 1px 2px black; color: var(--accent-text); } button:active {background: var(--accent-color); color: var(--accent-text); box-shadow: inset 2px 2px 5px black; } dialog {align-items: end; background: rgba(255, 255, 255, 0.1); border-radius: 10px; display: flex; flex-direction: column; gap: .5rem; opacity: 1; padding: 0; transition: opacity .3s ease-out; } dialog.fade {opacity: 0; } dialog::backdrop {background: rgba(0, 0, 0, 0.7); opacity: 1; transition: all .3s ease-out; } dialog.fade::backdrop {opacity: 0; } </style> <a href="#" id="edit-link"> <slot>Change your cookie preferences.</slot> </a> <dialog class="fade" id="edit-dialog"> <button id="close">✖</button> \x3c!-- a-consent element will be appended here --\x3e </dialog> ';constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){customElements.whenDefined("a-consent").then((()=>{if(""===this.shadowRoot.innerHTML){this.shadowRoot.innerHTML=o.template,this.dialog=this.shadowRoot.querySelector("dialog#edit-dialog");const t=this.shadowRoot.querySelector("#edit-link"),e=this.shadowRoot.querySelector("#close");if(!this.dialog||!t||!e)return void console.error("AConsentEdit: Could not find essential elements in the template.");t.addEventListener("click",this.showForm.bind(this),{signal:this.abortController.signal}),e.addEventListener("click",this.hideForm.bind(this),{signal:this.abortController.signal}),this.dialog.addEventListener("click",(t=>{t.target===this.dialog&&this.hideForm()}),{signal:this.abortController.signal})}})).catch((t=>{console.error("AConsentEdit: Failed waiting for a-consent definition.",t)}))}disconnectedCallback(){this.abortController.abort(),this.abortTransitionController?.abort(),this.dialog&&this.dialog.open&&this.dialog.close(),this.consentForm?.remove(),this.consentForm=null}hideForm(){this.dialog&&this.dialog.open&&(this.abortTransitionController?.abort(),this.abortTransitionController=new AbortController,this.dialog.classList.add("fade"),this.dialog.addEventListener("transitionend",(t=>{t.target===this.dialog&&"opacity"===t.propertyName&&(this.dialog?.close(),this.consentForm?.remove(),this.consentForm=null,this.abortTransitionController?.abort(),this.abortTransitionController=null)}),{signal:this.abortTransitionController.signal}),setTimeout((()=>{this.abortTransitionController&&!this.abortTransitionController.signal.aborted&&(this.dialog?.close(),this.consentForm?.remove(),this.consentForm=null,this.abortTransitionController.abort(),this.abortTransitionController=null)}),500))}showForm(t){if(t.preventDefault(),this.dialog){if(!this.dialog.open)if(void 0!==a){this.consentForm?.remove();try{this.consentForm=document.createElement("a-consent"),this.consentForm.force=!0,this.dialog.append(this.consentForm),this.dialog.showModal(),requestAnimationFrame((()=>{this.dialog?.classList.remove("fade")}))}catch(t){console.error("AConsentEdit: Failed to create or show a-consent form.",t),this.consentForm?.remove(),this.consentForm=null,this.dialog.open&&this.dialog.close()}}else console.error("AConsentEdit: AConsent class is not defined.")}else console.error("AConsentEdit: Dialog element not found.")}}document.addEventListener("DOMContentLoaded",(()=>{customElements.get("a-consent-edit")||customElements.define("a-consent-edit",o)}));export{o as AConsentEdit,a as default};
